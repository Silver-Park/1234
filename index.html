<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÎèôÍ∑∏ÎùºÎØ∏ Ïà´Ïûê ÎπàÎèÑ Î∂ÑÏÑùÍ∏∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background: linear-gradient(135deg, #EFF6FF 0%, #E0E7FF 100%);
            min-height: 100vh;
            padding: 0.5rem;
        }

        @media (min-width: 640px) {
            body {
                padding: 1rem;
            }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            font-size: 1.25rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 0.75rem;
            color: #3730A3;
        }

        @media (min-width: 640px) {
            h1 {
                font-size: 1.875rem;
            }
        }

        .input-section {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 0.75rem;
            margin-bottom: 0.75rem;
        }

        label {
            display: block;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #374151;
        }

        .hint {
            font-size: 0.75rem;
            color: #4B5563;
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        textarea {
            width: 100%;
            height: 10rem;
            padding: 0.75rem;
            border: 2px solid #D1D5DB;
            border-radius: 0.5rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #6366F1;
        }

        button {
            margin-top: 0.75rem;
            width: 100%;
            background: #6366F1;
            color: white;
            font-weight: bold;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        button:hover {
            background: #4F46E5;
        }

        button:active {
            background: #4338CA;
        }

        .analysis-box {
            background: linear-gradient(135deg, #F5F3FF 0%, #EFF6FF 100%);
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 1rem;
            margin-bottom: 0.75rem;
            border: 1px solid #E5E7EB;
        }

        .analysis-title {
            font-size: 1.125rem;
            font-weight: bold;
            margin-bottom: 0.75rem;
            color: #1F2937;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .card {
            background: white;
            border-radius: 0.5rem;
            padding: 0.75rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .card-label {
            font-size: 0.75rem;
            color: #4B5563;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .number-display {
            display: flex;
            justify-content: center;
            gap: 0.25rem;
            font-size: 1.5rem;
            margin: 0.5rem 0;
        }

        .number-display span {
            font-size: 1.875rem;
        }

        .dividend-value {
            font-size: 1.25rem;
            font-weight: bold;
            color: #1F2937;
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 0.25rem;
        }

        .proportion-value {
            font-size: 1.125rem;
            font-weight: bold;
            color: #059669;
            margin-top: 0.25rem;
        }

        .ratio-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .ratio-box {
            border-radius: 0.5rem;
            padding: 0.75rem;
            border: 1px solid #D1D5DB;
        }

        .ratio-box.yellow {
            background: #FEF3C7;
            border-color: #FDE68A;
        }

        .ratio-label {
            font-size: 0.75rem;
            margin-bottom: 0.25rem;
            font-weight: 600;
        }

        .ratio-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .ratio-formula {
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }

        .total-ratio-box {
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 1rem;
            margin-bottom: 0.75rem;
            border: 2px solid #E5E7EB;
        }

        .total-ratio-title {
            font-size: 1.125rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: black;
        }

        .total-ratio-value {
            font-size: 1.875rem;
            font-weight: bold;
            color: black;
        }

        .total-ratio-formula {
            font-size: 0.875rem;
            color: black;
            margin-top: 0.25rem;
        }

        .info-box {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .info-title {
            font-size: 0.875rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #374151;
        }

        .gradient-bar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
        }

        .gradient-box {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .color-sample {
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 0.25rem;
        }

        .gradient-fill {
            flex: 1;
            height: 1.25rem;
            border-radius: 0.25rem;
            background: linear-gradient(to right, rgb(96, 165, 250), rgb(255, 255, 255), rgb(239, 68, 68));
        }

        .info-text {
            font-size: 0.75rem;
            color: #4B5563;
            margin-top: 0.5rem;
        }

        .table-container {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        .table-title {
            font-size: 1rem;
            font-weight: bold;
            padding: 0.75rem;
            background: #F9FAFB;
            border-bottom: 1px solid #E5E7EB;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
            table-layout: fixed;
        }

        th, td {
            border: 1px solid #D1D5DB;
            padding: 0.5rem;
            text-align: center;
        }

        th {
            background: #F3F4F6;
            font-weight: bold;
            font-size: 0.875rem;
        }

        th.orange-bg {
            background: #FED7AA;
        }

        td.yellow-bg {
            background: #FDE047;
            font-size: 1.5rem;
        }

        td.orange-bg {
            background: #FEF3C7;
        }

        td.value-cell {
            font-weight: bold;
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî¢ ÎèôÍ∑∏ÎùºÎØ∏ Ïà´Ïûê ÎπàÎèÑ Î∂ÑÏÑùÍ∏∞</h1>

        <div class="input-section">
            <label>Îç∞Ïù¥ÌÑ∞ ÏûÖÎ†• (ÏûêÏú† ÌòïÏãù)</label>
            <p class="hint">
                ÎèôÍ∑∏ÎùºÎØ∏ Ïà´Ïûê 6Í∞úÍ∞Ä 1Ï§ÑÏûÖÎãàÎã§. Ïà´ÏûêÎÇò Í≥µÎ∞±ÏùÄ Î¨¥ÏãúÎêòÎ©∞ ÎèôÍ∑∏ÎùºÎØ∏ Ïà´ÏûêÎßå Ï∂îÏ∂úÎê©ÎãàÎã§.<br/>
                Ïòà: ‚ë•‚ë™ 4.6 ‚ë•‚ë£ 6.8 ‚ë•‚ë¢ 7.3 (Ïù¥Î†áÍ≤å ÏûÖÎ†•Ìï¥ÎèÑ ÏûêÎèôÏúºÎ°ú ‚ë•‚ë™‚ë•‚ë£‚ë•‚ë¢Î°ú Ïù∏Ïãù)
            </p>
            <textarea id="inputData" placeholder="ÏòàÏãú:
‚ë•‚ë™ 4.6 ‚ë•‚ë£ 6.8 ‚ë•‚ë¢ 7.3
‚ë•‚ë§ 8.5 ‚ë™‚ë• 11.6 ‚ë•‚ë° 13.5"></textarea>
            <button onclick="analyzeData()">Î∂ÑÏÑùÌïòÍ∏∞</button>
        </div>

        <div id="results"></div>
    </div>

    <script>
        let results = null;
        let analysis1 = null;
        let analysis2 = null;
        let analysis3 = null;

        function extractNumbers(pair) {
            return pair.split('');
        }

        function analyzeData() {
            const inputData = document.getElementById('inputData').value;
            
            if (!inputData.trim()) {
                alert('Îç∞Ïù¥ÌÑ∞Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }

            const circledNumbers = ['‚ë†', '‚ë°', '‚ë¢', '‚ë£', '‚ë§', '‚ë•', '‚ë¶', '‚ëß', '‚ë®', '‚ë©', '‚ë™', '‚ë´', '‚ë¨', '‚ë≠', '‚ëÆ', '‚ëØ'];
            
            const pairs = [];
            const dividends = [];
            
            const tokens = inputData.match(/[‚ë†‚ë°‚ë¢‚ë£‚ë§‚ë•‚ë¶‚ëß‚ë®‚ë©‚ë™‚ë´‚ë¨‚ë≠‚ëÆ‚ëØ]|[\d.]+/g) || [];
            
            for (let i = 0; i < tokens.length - 2; i++) {
                if (circledNumbers.includes(tokens[i]) && 
                    circledNumbers.includes(tokens[i + 1]) &&
                    !isNaN(parseFloat(tokens[i + 2]))) {
                    pairs.push(tokens[i] + tokens[i + 1]);
                    dividends.push(parseFloat(tokens[i + 2]));
                }
            }
            
            const sortedData = pairs.map((pair, idx) => ({
                pair: pair,
                dividend: dividends[idx]
            })).sort((a, b) => a.dividend - b.dividend);
            
            // ÍµêÏ∞®Ï†êÎ∂ÑÏÑù1
            let lowest1 = null;
            let lowest2 = null;
            let crossPoint1 = null;
            
            if (sortedData.length >= 2) {
                lowest1 = sortedData[0];
                lowest2 = sortedData[1];
                
                const num1_1 = lowest1.pair[0];
                const num1_2 = lowest1.pair[1];
                const num2_1 = lowest2.pair[0];
                const num2_2 = lowest2.pair[1];
                
                let crossNum1, crossNum2;
                
                if (num1_1 === num2_1) {
                    crossNum1 = num1_2;
                    crossNum2 = num2_2;
                } else if (num1_1 === num2_2) {
                    crossNum1 = num1_2;
                    crossNum2 = num2_1;
                } else if (num1_2 === num2_1) {
                    crossNum1 = num1_1;
                    crossNum2 = num2_2;
                } else if (num1_2 === num2_2) {
                    crossNum1 = num1_1;
                    crossNum2 = num2_1;
                }
                
                const crossPair1_1 = crossNum1 + crossNum2;
                const crossPair1_2 = crossNum2 + crossNum1;
                
                const crossIdx1 = pairs.indexOf(crossPair1_1);
                const crossIdx2 = pairs.indexOf(crossPair1_2);
                
                if (crossIdx1 !== -1) {
                    crossPoint1 = {
                        pair: crossPair1_1,
                        dividend: dividends[crossIdx1]
                    };
                } else if (crossIdx2 !== -1) {
                    crossPoint1 = {
                        pair: crossPair1_2,
                        dividend: dividends[crossIdx2]
                    };
                }
                
                if (crossPoint1) {
                    const sum1 = lowest1.dividend + lowest2.dividend + crossPoint1.dividend;
                    const ratio1 = ((lowest1.dividend * lowest2.dividend) / crossPoint1.dividend).toFixed(6);
                    const addRatio1 = ((lowest1.dividend + lowest2.dividend) / crossPoint1.dividend).toFixed(6);
                    
                    analysis1 = {
                        ratio: ratio1,
                        addRatio: addRatio1,
                        items: [
                            {
                                label: 'ÏµúÏ†ÄÎ∞∞Îãπ1',
                                pair: lowest1.pair,
                                dividend: lowest1.dividend,
                                proportion: (lowest1.dividend / sum1) * 100
                            },
                            {
                                label: 'ÏµúÏ†ÄÎ∞∞Îãπ2',
                                pair: lowest2.pair,
                                dividend: lowest2.dividend,
                                proportion: (lowest2.dividend / sum1) * 100
                            },
                            {
                                label: 'ÍµêÏ∞®Ï†ê',
                                pair: crossPoint1.pair,
                                dividend: crossPoint1.dividend,
                                proportion: (crossPoint1.dividend / sum1) * 100
                            }
                        ]
                    };
                }
            }
            
            // ÍµêÏ∞®Ï†êÎ∂ÑÏÑù2
            if (analysis1 && sortedData.length >= 3) {
                const usedNumbers1 = new Set([
                    ...extractNumbers(analysis1.items[0].pair),
                    ...extractNumbers(analysis1.items[1].pair),
                    ...extractNumbers(analysis1.items[2].pair)
                ]);
                
                const availablePairs = sortedData.filter(item => {
                    const nums = extractNumbers(item.pair);
                    return !nums.some(n => usedNumbers1.has(n));
                });
                
                if (availablePairs.length >= 2) {
                    const pair2_1 = availablePairs[0];
                    const pair2_2 = availablePairs[1];
                    
                    const num1_1 = pair2_1.pair[0];
                    const num1_2 = pair2_1.pair[1];
                    const num2_1 = pair2_2.pair[0];
                    const num2_2 = pair2_2.pair[1];
                    
                    let crossNum1, crossNum2;
                    
                    if (num1_1 === num2_1) {
                        crossNum1 = num1_2;
                        crossNum2 = num2_2;
                    } else if (num1_1 === num2_2) {
                        crossNum1 = num1_2;
                        crossNum2 = num2_1;
                    } else if (num1_2 === num2_1) {
                        crossNum1 = num1_1;
                        crossNum2 = num2_2;
                    } else if (num1_2 === num2_2) {
                        crossNum1 = num1_1;
                        crossNum2 = num2_1;
                    }
                    
                    const crossPair2_1 = crossNum1 + crossNum2;
                    const crossPair2_2 = crossNum2 + crossNum1;
                    
                    const crossIdx1 = pairs.indexOf(crossPair2_1);
                    const crossIdx2 = pairs.indexOf(crossPair2_2);
                    
                    let crossPoint2 = null;
                    if (crossIdx1 !== -1) {
                        crossPoint2 = {
                            pair: crossPair2_1,
                            dividend: dividends[crossIdx1]
                        };
                    } else if (crossIdx2 !== -1) {
                        crossPoint2 = {
                            pair: crossPair2_2,
                            dividend: dividends[crossIdx2]
                        };
                    }
                    
                    if (crossPoint2) {
                        const sum2 = pair2_1.dividend + pair2_2.dividend + crossPoint2.dividend;
                        const ratio2 = ((pair2_1.dividend * pair2_2.dividend) / crossPoint2.dividend).toFixed(6);
                        const addRatio2 = ((pair2_1.dividend + pair2_2.dividend) / crossPoint2.dividend).toFixed(6);
                        
                        analysis2 = {
                            ratio: ratio2,
                            addRatio: addRatio2,
                            items: [
                                {
                                    label: '1Î≤àÏßù',
                                    pair: pair2_1.pair,
                                    dividend: pair2_1.dividend,
                                    proportion: (pair2_1.dividend / sum2) * 100
                                },
                                {
                                    label: '2Î≤àÏßù',
                                    pair: pair2_2.pair,
                                    dividend: pair2_2.dividend,
                                    proportion: (pair2_2.dividend / sum2) * 100
                                },
                                {
                                    label: 'ÍµêÏ∞®Ï†ê',
                                    pair: crossPoint2.pair,
                                    dividend: crossPoint2.dividend,
                                    proportion: (crossPoint2.dividend / sum2) * 100
                                }
                            ]
                        };
                    }
                }
            }
            
            // ÍµêÏ∞®Ï†êÎ∂ÑÏÑù3
            if (analysis1 && analysis2 && sortedData.length >= 3) {
                const usedNumbers2 = new Set([
                    ...extractNumbers(analysis1.items[0].pair),
                    ...extractNumbers(analysis1.items[1].pair),
                    ...extractNumbers(analysis1.items[2].pair),
                    ...extractNumbers(analysis2.items[0].pair),
                    ...extractNumbers(analysis2.items[1].pair),
                    ...extractNumbers(analysis2.items[2].pair)
                ]);
                
                const availablePairs = sortedData.filter(item => {
                    const nums = extractNumbers(item.pair);
                    return !nums.some(n => usedNumbers2.has(n));
                });
                
                if (availablePairs.length >= 2) {
                    const pair3_1 = availablePairs[0];
                    const pair3_2 = availablePairs[1];
                    
                    const num1_1 = pair3_1.pair[0];
                    const num1_2 = pair3_1.pair[1];
                    const num2_1 = pair3_2.pair[0];
                    const num2_2 = pair3_2.pair[1];
                    
                    let crossNum1, crossNum2;
                    
                    if (num1_1 === num2_1) {
                        crossNum1 = num1_2;
                        crossNum2 = num2_2;
                    } else if (num1_1 === num2_2) {
                        crossNum1 = num1_2;
                        crossNum2 = num2_1;
                    } else if (num1_2 === num2_1) {
                        crossNum1 = num1_1;
                        crossNum2 = num2_2;
                    } else if (num1_2 === num2_2) {
                        crossNum1 = num1_1;
                        crossNum2 = num2_1;
                    }
                    
                    const crossPair3_1 = crossNum1 + crossNum2;
                    const crossPair3_2 = crossNum2 + crossNum1;
                    
                    const crossIdx1 = pairs.indexOf(crossPair3_1);
                    const crossIdx2 = pairs.indexOf(crossPair3_2);
                    
                    let crossPoint3 = null;
                    if (crossIdx1 !== -1) {
                        crossPoint3 = {
                            pair: crossPair3_1,
                            dividend: dividends[crossIdx1]
                        };
                    } else if (crossIdx2 !== -1) {
                        crossPoint3 = {
                            pair: crossPair3_2,
                            dividend: dividends[crossIdx2]
                        };
                    }
                    
                    if (crossPoint3) {
                        const sum3 = pair3_1.dividend + pair3_2.dividend + crossPoint3.dividend;
                        const ratio3 = ((pair3_1.dividend * pair3_2.dividend) / crossPoint3.dividend).toFixed(6);
                        const addRatio3 = ((pair3_1.dividend + pair3_2.dividend) / crossPoint3.dividend).toFixed(6);
                        
                        analysis3 = {
                            ratio: ratio3,
                            addRatio: addRatio3,
                            items: [
                                {
                                    label: '1ÏúÑ',
                                    pair: pair3_1.pair,
                                    dividend: pair3_1.dividend,
                                    proportion: (pair3_1.dividend / sum3) * 100
                                },
                                {
                                    label: '2ÏúÑ',
                                    pair: pair3_2.pair,
                                    dividend: pair3_2.dividend,
                                    proportion: (pair3_2.dividend / sum3) * 100
                                },
                                {
                                    label: 'ÍµêÏ∞®Ï†ê',
                                    pair: crossPoint3.pair,
                                    dividend: crossPoint3.dividend,
                                    proportion: (crossPoint3.dividend / sum3) * 100
                                }
                            ]
                        };
                    }
                }
            }
            
            // ÎπàÎèÑ Î∂ÑÏÑù
            const allCircledNums = [];
            for (let char of inputData) {
                if (circledNumbers.includes(char)) {
                    allCircledNums.push(char);
                }
            }
            
            const lines = [];
            for (let i = 0; i < allCircledNums.length; i += 6) {
                const lineNums = allCircledNums.slice(i, i + 6);
                if (lineNums.length > 0) {
                    lines.push(lineNums.join(' '));
                }
            }
            
            const countNumbers = (text) => {
                const counts = {};
                circledNumbers.forEach(num => {
                    const matches = text.match(new RegExp(num, 'g'));
                    counts[num] = matches ? matches.length : 0;
                });
                return counts;
            };

            const lines1to3 = lines.slice(0, 3).join('\n');
            const result1to3 = countNumbers(lines1to3);
            const lines4to6 = lines.slice(3, 6).join('\n');
            const result4to6 = countNumbers(lines4to6);
            const lines7to10 = lines.slice(6, 10).join('\n');
            const result7to10 = countNumbers(lines7to10);
            const lines1to10 = lines.slice(0, 10).join('\n');
            const result1to10 = countNumbers(lines1to10);

            let result11to13 = null, result14to16 = null, result17to20 = null, result11to20 = null, resultCumulative20 = null;
            if (lines.length > 10) {
                result11to13 = countNumbers(lines.slice(10, 13).join('\n'));
                result14to16 = countNumbers(lines.slice(13, 16).join('\n'));
                result17to20 = countNumbers(lines.slice(16, 20).join('\n'));
                result11to20 = countNumbers(lines.slice(10, 20).join('\n'));
                resultCumulative20 = countNumbers(lines.slice(0, 20).join('\n'));
            }

            let result21to23 = null, result24to26 = null, result27to30 = null, result21to30 = null, resultCumulative30 = null;
            if (lines.length > 20) {
                result21to23 = countNumbers(lines.slice(20, 23).join('\n'));
                result24to26 = countNumbers(lines.slice(23, 26).join('\n'));
                result27to30 = countNumbers(lines.slice(26, 30).join('\n'));
                result21to30 = countNumbers(lines.slice(20, 30).join('\n'));
                resultCumulative30 = countNumbers(lines.slice(0, 30).join('\n'));
            }

            let result31to33 = null, result34to36 = null, result37to40 = null, result31to40 = null, resultCumulative40 = null;
            if (lines.length > 30) {
                result31to33 = countNumbers(lines.slice(30, 33).join('\n'));
                result34to36 = countNumbers(lines.slice(33, 36).join('\n'));
                result37to40 = countNumbers(lines.slice(36, 40).join('\n'));
                result31to40 = countNumbers(lines.slice(30, 40).join('\n'));
                resultCumulative40 = countNumbers(lines.slice(0, 40).join('\n'));
            }

            let result41to43 = null, result44to46 = null, result47to50 = null, result41to50 = null, resultCumulative50 = null;
            if (lines.length > 40) {
                result41to43 = countNumbers(lines.slice(40, 43).join('\n'));
                result44to46 = countNumbers(lines.slice(43, 46).join('\n'));
                result47to50 = countNumbers(lines.slice(46, 50).join('\n'));
                result41to50 = countNumbers(lines.slice(40, 50).join('\n'));
                resultCumulative50 = countNumbers(lines.slice(0, 50).join('\n'));
            }

            results = {
                first10: { section1: result1to3, section2: result4to6, section3: result7to10, all: result1to10 },
                second10: result11to20 ? { section1: result11to13, section2: result14to16, section3: result17to20, all: result11to20, cumulative: resultCumulative20 } : null,
                third10: result21to30 ? { section1: result21to23, section2: result24to26, section3: result27to30, all: result21to30, cumulative: resultCumulative30 } : null,
                fourth10: result31to40 ? { section1: result31to33, section2: result34to36, section3: result37to40, all: result31to40, cumulative: resultCumulative40 } : null,
                fifth10: result41to50 ? { section1: result41to43, section2: result44to46, section3: result47to50, all: result41to50, cumulative: resultCumulative50 } : null
            };

            renderResults();
        }

        function getGradientColor(count, minCount, maxCount) {
            if (maxCount === 0) return 'rgb(96, 165, 250)';
            const ratio = count / maxCount;
            let r, g, b;
            if (ratio <= 0.5) {
                const normalizedRatio = ratio * 2;
                r = Math.round(96 + (255 - 96) * normalizedRatio);
                g = Math.round(165 + (255 - 165) * normalizedRatio);
                b = Math.round(250 + (255 - 250) * normalizedRatio);
            } else {
                const normalizedRatio = (ratio - 0.5) * 2;
                r = Math.round(255 + (239 - 255) * normalizedRatio);
                g = Math.round(255 + (68 - 255) * normalizedRatio);
                b = Math.round(255 + (68 - 255) * normalizedRatio);
            }
            return `rgb(${r}, ${g}, ${b})`;
        }

        function getAddRatioColor(value, minValue, maxValue) {
            if (value < minValue) value = minValue;
            if (value > maxValue) value = maxValue;
            const ratio = (value - minValue) / (maxValue - minValue);
            let r, g, b;
            if (ratio <= 0.5) {
                const normalizedRatio = ratio * 2;
                r = Math.round(96 + (255 - 96) * normalizedRatio);
                g = Math.round(165 + (255 - 165) * normalizedRatio);
                b = Math.round(250 + (255 - 250) * normalizedRatio);
            } else {
                const normalizedRatio = (ratio - 0.5) * 2;
                r = Math.round(255 + (239 - 255) * normalizedRatio);
                g = Math.round(255 + (68 - 255) * normalizedRatio);
                b = Math.round(255 + (68 - 255) * normalizedRatio);
            }
            return `rgb(${r}, ${g}, ${b})`;
        }

        function getDividendColor(dividend) {
            if (dividend <= 1.0) {
                return 'rgb(96, 165, 250)';
            } else if (dividend >= 5.0 && dividend < 7.0) {
                return 'rgb(251, 146, 60)';
            } else if (dividend >= 7.0) {
                return 'rgb(239, 68, 68)';
            } else {
                return 'transparent';
            }
        }

        function renderTable(data, title, hasCumulative = false) {
            if (!data) return '';
            const circledNumbers = ['‚ë†', '‚ë°', '‚ë¢', '‚ë£', '‚ë§', '‚ë•', '‚ë¶', '‚ëß', '‚ë®', '‚ë©', '‚ë™', '‚ë´', '‚ë¨', '‚ë≠', '‚ëÆ', '‚ëØ'];
            const getMax = (dataObj) => Math.max(...Object.values(dataObj));
            const maxValues = {
                section1: getMax(data.section1), section2: getMax(data.section2),
                section3: getMax(data.section3), all: getMax(data.all)
            };
            if (hasCumulative && data.cumulative) maxValues.cumulative = getMax(data.cumulative);
            const colWidth = hasCumulative ? '9%' : '11%';
            const colWidthValue = hasCumulative ? '11%' : '14%';

            let html = `<div class="table-container">
                <div class="table-title">${title}</div>
                <table>
                    <colgroup>
                        <col style="width: ${colWidth}" /><col style="width: ${colWidthValue}" />
                        <col style="width: ${colWidth}" /><col style="width: ${colWidthValue}" />
                        <col style="width: ${colWidth}" /><col style="width: ${colWidthValue}" />
                        <col style="width: ${colWidth}" /><col style="width: ${colWidthValue}" />
                        ${hasCumulative ? `<col style="width: ${colWidth}" /><col style="width: ${colWidthValue}" />` : ''}
                    </colgroup>
                    <thead><tr>
                        <th>Ï≤´Î∂ÄÎ∂Ñ</th><th></th>
                        <th>Ï§ëÍ∞Ñ</th><th></th>
                        <th>ÏïÑÎû´Î∂ÄÎ∂Ñ</th><th></th>
                        <th>Ï†ÑÏ≤¥</th><th></th>
                        ${hasCumulative ? `<th class="orange-bg">ÎàÑÏ†ÅÏ†ÑÏ≤¥</th><th class="orange-bg"></th>` : ''}
                    </tr></thead><tbody>`;

            circledNumbers.forEach(num => {
                html += `<tr>
                    <td class="yellow-bg">${num}</td>
                    <td class="value-cell" style="background-color: ${getGradientColor(data.section1[num], 0, maxValues.section1)}">${data.section1[num]}</td>
                    <td class="yellow-bg">${num}</td>
                    <td class="value-cell" style="background-color: ${getGradientColor(data.section2[num], 0, maxValues.section2)}">${data.section2[num]}</td>
                    <td class="yellow-bg">${num}</td>
                    <td class="value-cell" style="background-color: ${getGradientColor(data.section3[num], 0, maxValues.section3)}">${data.section3[num]}</td>
                    <td class="yellow-bg">${num}</td>
                    <td class="value-cell" style="background-color: ${getGradientColor(data.all[num], 0, maxValues.all)}">${data.all[num]}</td>
                    ${hasCumulative && data.cumulative ? `
                        <td class="yellow-bg">${num}</td>
                        <td class="value-cell orange-bg" style="background-color: ${getGradientColor(data.cumulative[num], 0, maxValues.cumulative)}">${data.cumulative[num]}</td>
                    ` : ''}
                </tr>`;
            });
            return html + `</tbody></table></div>`;
        }

        function renderResults() {
            let html = '<div>';

            // ÍµêÏ∞®Ï†êÎ∂ÑÏÑù1
            if (analysis1) {
                html += `<div class="analysis-box">
                    <div class="analysis-title">üìä ÍµêÏ∞®Ï†êÎ∂ÑÏÑù1</div>
                    <div class="cards-grid">`;
                analysis1.items.forEach((item, idx) => {
                    const bgColor = idx === 0 ? getDividendColor(item.dividend) : 'transparent';
                    html += `<div class="card">
                        <div class="card-label">${item.label}</div>
                        <div class="number-display">
                            ${item.pair.split('').map(c => `<span>${c}</span>`).join('')}
                        </div>
                        <div class="dividend-value" style="background-color: ${bgColor}">${item.dividend}</div>
                        <div class="proportion-value">${item.proportion.toFixed(2)}%</div>
                    </div>`;
                });
                html += `</div><div class="ratio-grid">
                    <div class="ratio-box yellow">
                        <div class="ratio-label" style="color: #78716C">ÎπÑÏú®</div>
                        <div class="ratio-value" style="color: #F59E0B">${analysis1.ratio}</div>
                        <div class="ratio-formula" style="color: #78716C">= (${analysis1.items[0].dividend} √ó ${analysis1.items[1].dividend}) / ${analysis1.items[2].dividend}</div>
                    </div>
                    <div class="ratio-box" style="background-color: ${getAddRatioColor(parseFloat(analysis1.addRatio), 0.1, 2.0)}">
                        <div class="ratio-label" style="color: black">ÎçîÌïòÍ∏∞ ÎπÑÏú®</div>
                        <div class="ratio-value" style="color: black">${analysis1.addRatio}</div>
                        <div class="ratio-formula" style="color: black">= (${analysis1.items[0].dividend} + ${analysis1.items[1].dividend}) / ${analysis1.items[2].dividend}</div>
                    </div>
                </div></div>`;
            }

            // ÍµêÏ∞®Ï†êÎ∂ÑÏÑù2
            if (analysis2) {
                html += `<div class="analysis-box">
                    <div class="analysis-title">üìà ÍµêÏ∞®Ï†êÎ∂ÑÏÑù2</div>
                    <div class="cards-grid">`;
                analysis2.items.forEach(item => {
                    html += `<div class="card">
                        <div class="card-label">${item.label}</div>
                        <div class="number-display">
                            ${item.pair.split('').map(c => `<span>${c}</span>`).join('')}
                        </div>
                        <div class="dividend-value">${item.dividend}</div>
                        <div class="proportion-value">${item.proportion.toFixed(2)}%</div>
                    </div>`;
                });
                html += `</div><div class="ratio-grid">
                    <div class="ratio-box yellow">
                        <div class="ratio-label" style="color: #78716C">ÎπÑÏú®</div>
                        <div class="ratio-value" style="color: #F59E0B">${analysis2.ratio}</div>
                        <div class="ratio-formula" style="color: #78716C">= (${analysis2.items[0].dividend} √ó ${analysis2.items[1].dividend}) / ${analysis2.items[2].dividend}</div>
                    </div>
                    <div class="ratio-box" style="background-color: ${getAddRatioColor(parseFloat(analysis2.addRatio), 0.1, 2.0)}">
                        <div class="ratio-label" style="color: black">ÎçîÌïòÍ∏∞ ÎπÑÏú®</div>
                        <div class="ratio-value" style="color: black">${analysis2.addRatio}</div>
                        <div class="ratio-formula" style="color: black">= (${analysis2.items[0].dividend} + ${analysis2.items[1].dividend}) / ${analysis2.items[2].dividend}</div>
                    </div>
                </div></div>`;
            }

            // ÍµêÏ∞®Ï†êÎ∂ÑÏÑù3
            if (analysis3) {
                html += `<div class="analysis-box">
                    <div class="analysis-title">üéØ ÍµêÏ∞®Ï†êÎ∂ÑÏÑù3</div>
                    <div class="cards-grid">`;
                analysis3.items.forEach(item => {
                    html += `<div class="card">
                        <div class="card-label">${item.label}</div>
                        <div class="number-display">
                            ${item.pair.split('').map(c => `<span>${c}</span>`).join('')}
                        </div>
                        <div class="dividend-value">${item.dividend}</div>
                        <div class="proportion-value">${item.proportion.toFixed(2)}%</div>
                    </div>`;
                });
                html += `</div><div class="ratio-grid">
                    <div class="ratio-box yellow">
                        <div class="ratio-label" style="color: #78716C">ÎπÑÏú®</div>
                        <div class="ratio-value" style="color: #F59E0B">${analysis3.ratio}</div>
                        <div class="ratio-formula" style="color: #78716C">= (${analysis3.items[0].dividend} √ó ${analysis3.items[1].dividend}) / ${analysis3.items[2].dividend}</div>
                    </div>
                    <div class="ratio-box" style="background-color: ${getAddRatioColor(parseFloat(analysis3.addRatio), 0.1, 2.0)}">
                        <div class="ratio-label" style="color: black">ÎçîÌïòÍ∏∞ ÎπÑÏú®</div>
                        <div class="ratio-value" style="color: black">${analysis3.addRatio}</div>
                        <div class="ratio-formula" style="color: black">= (${analysis3.items[0].dividend} + ${analysis3.items[1].dividend}) / ${analysis3.items[2].dividend}</div>
                    </div>
                </div></div>`;
            }

            // Ìï©ÏÇ∞ ÎπÑÏú®
            if (analysis1 && analysis2 && analysis3) {
                const totalAddRatio = (parseFloat(analysis1.addRatio) + parseFloat(analysis2.addRatio) + parseFloat(analysis3.addRatio)).toFixed(6);
                html += `<div class="total-ratio-box" style="background-color: ${getAddRatioColor(parseFloat(totalAddRatio), 2.0, 5.0)}">
                    <div class="total-ratio-title">üìä Ìï©ÏÇ∞ ÎπÑÏú®</div>
                    <div class="total-ratio-value">${totalAddRatio}</div>
                    <div class="total-ratio-formula">= ${analysis1.addRatio} + ${analysis2.addRatio} + ${analysis3.addRatio}</div>
                </div>`;
            }

            // ÏÉâÏÉÅ ÏïàÎÇ¥
            html += `<div class="info-box">
                <div class="info-title">ÏÉâÏÉÅ ÏïàÎÇ¥</div>
                <div class="gradient-bar">
                    <div class="gradient-box">
                        <div class="color-sample" style="background: rgb(96, 165, 250)"></div>
                        <span>0 (ÏµúÏ†Ä)</span>
                    </div>
                    <div class="gradient-fill"></div>
                    <div class="gradient-box">
                        <div class="color-sample" style="background: rgb(239, 68, 68)"></div>
                        <span>ÏµúÍ≥†</span>
                    </div>
                </div>
                <div class="info-text">Í∞Å Íµ¨Í∞ÑÎ≥ÑÎ°ú ÏÉÅÎåÄÏ†ÅÏù∏ ÎπàÎèÑÏóê Îî∞Îùº ÏÉâÏÉÅÏù¥ Í∑∏ÎùºÎç∞Ïù¥ÏÖòÏúºÎ°ú ÌëúÏãúÎê©ÎãàÎã§.</div>
            </div>`;

            html += renderTable(results.first10, "1-10Ï§Ñ Î∂ÑÏÑù");
            if (results.second10) html += renderTable(results.second10, "11-20Ï§Ñ Î∂ÑÏÑù", true);
            if (results.third10) html += renderTable(results.third10, "21-30Ï§Ñ Î∂ÑÏÑù", true);
            if (results.fourth10) html += renderTable(results.fourth10, "31-40Ï§Ñ Î∂ÑÏÑù", true);
            if (results.fifth10) html += renderTable(results.fifth10, "41-50Ï§Ñ Î∂ÑÏÑù", true);

            document.getElementById('results').innerHTML = html + '</div>';
        }
    </script>
</body>
</html>
